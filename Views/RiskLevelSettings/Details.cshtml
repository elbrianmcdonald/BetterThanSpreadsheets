@model CyberRiskApp.Models.RiskLevelSettings
@{
    ViewData["Title"] = "Current Risk Level Settings";
}

<style>
    .settings-header {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        border-radius: 15px;
        margin-bottom: 30px;
        padding: 20px;
    }

    .threshold-card {
        background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
        border: none;
        border-radius: 15px;
        padding: 20px;
        margin-bottom: 20px;
        box-shadow: 0 4px 15px rgba(0,0,0,0.1);
    }

    .threshold-item {
        padding: 10px 15px;
        margin: 5px 0;
        border-radius: 8px;
        border-left: 4px solid;
        background: white;
    }

    .threshold-critical {
        border-left-color: #dc3545;
    }

    .threshold-high {
        border-left-color: #fd7e14;
    }

    .threshold-medium {
        border-left-color: #0dcaf0;
    }

    .threshold-low {
        border-left-color: #198754;
    }

    .preview-section {
        background: #f8f9fa;
        border-radius: 10px;
        padding: 20px;
        margin-top: 20px;
    }

    .sample-risk {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 8px 15px;
        margin: 5px 0;
        background: white;
        border-radius: 6px;
        border-left: 3px solid;
    }
</style>

<div class="container-fluid">
    <!-- Header Section -->
    <div class="settings-header">
        <div class="row align-items-center">
            <div class="col">
                <div class="d-flex align-items-center mb-2">
                    @if (Model.IsActive)
                    {
                        <span class="badge bg-success me-3">
                            <i class="fas fa-check me-1"></i>Active Configuration
                        </span>
                    }
                    else
                    {
                        <span class="badge bg-secondary me-3">
                            <i class="fas fa-archive me-1"></i>Archived Configuration
                        </span>
                    }
                </div>
                <h2 class="mb-1">@Model.Name</h2>
                <p class="mb-0">@Model.Description</p>
            </div>
            <div class="col-auto">
                <a asp-action="Edit" asp-route-id="@Model.Id" class="btn btn-warning btn-lg me-2">
                    <i class="fas fa-edit me-2"></i>Edit Settings
                </a>
                <a asp-action="Index" class="btn btn-light btn-lg">
                    <i class="fas fa-list me-2"></i>All Settings
                </a>
            </div>
        </div>
    </div>

    @if (TempData["Success"] != null)
    {
        <div class="alert alert-success alert-dismissible fade show">
            <i class="fas fa-check-circle me-2"></i>@TempData["Success"]
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        </div>
    }

    <!-- Settings Details -->
    <div class="row">
        <!-- FAIR Thresholds -->
        <div class="col-md-6">
            <div class="threshold-card">
                <h4 class="text-primary mb-3">
                    <i class="fas fa-calculator me-2"></i>FAIR Assessment Thresholds
                </h4>
                <p class="text-muted mb-4">Annual Loss Expectancy (ALE) values in USD</p>

                <div class="threshold-item threshold-critical">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <span class="badge bg-danger me-2">Critical</span>
                            <strong>@Model.GetFairCriticalRange()</strong>
                        </div>
                        <span class="text-muted small">$@Model.FairCriticalThreshold.ToString("N0") and above</span>
                    </div>
                </div>

                <div class="threshold-item threshold-high">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <span class="badge bg-warning me-2">High</span>
                            <strong>@Model.GetFairHighRange()</strong>
                        </div>
                        <span class="text-muted small">$@Model.FairHighThreshold.ToString("N0") to $@((Model.FairCriticalThreshold - 1).ToString("N0"))</span>
                    </div>
                </div>

                <div class="threshold-item threshold-medium">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <span class="badge bg-info me-2">Medium</span>
                            <strong>@Model.GetFairMediumRange()</strong>
                        </div>
                        <span class="text-muted small">$@Model.FairMediumThreshold.ToString("N0") to $@((Model.FairHighThreshold - 1).ToString("N0"))</span>
                    </div>
                </div>

                <div class="threshold-item threshold-low">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <span class="badge bg-success me-2">Low</span>
                            <strong>@Model.GetFairLowRange()</strong>
                        </div>
                        <span class="text-muted small">Below $@Model.FairMediumThreshold.ToString("N0")</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Qualitative Thresholds -->
        <div class="col-md-6">
            <div class="threshold-card">
                <h4 class="text-success mb-3">
                    <i class="fas fa-chart-bar me-2"></i>Qualitative Assessment Thresholds
                </h4>
                <p class="text-muted mb-4">Risk Score values (Likelihood × Impact × Exposure)</p>

                <div class="threshold-item threshold-critical">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <span class="badge bg-danger me-2">Critical</span>
                            <strong>@Model.GetQualitativeCriticalRange()</strong>
                        </div>
                        <span class="text-muted small">Score @Model.QualitativeCriticalThreshold and above</span>
                    </div>
                </div>

                <div class="threshold-item threshold-high">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <span class="badge bg-warning me-2">High</span>
                            <strong>@Model.GetQualitativeHighRange()</strong>
                        </div>
                        <span class="text-muted small">Score @Model.QualitativeHighThreshold to @(Model.QualitativeCriticalThreshold - 0.1m)</span>
                    </div>
                </div>

                <div class="threshold-item threshold-medium">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <span class="badge bg-info me-2">Medium</span>
                            <strong>@Model.GetQualitativeMediumRange()</strong>
                        </div>
                        <span class="text-muted small">Score @Model.QualitativeMediumThreshold to @(Model.QualitativeHighThreshold - 0.1m)</span>
                    </div>
                </div>

                <div class="threshold-item threshold-low">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <span class="badge bg-success me-2">Low</span>
                            <strong>@Model.GetQualitativeLowRange()</strong>
                        </div>
                        <span class="text-muted small">Below @Model.QualitativeMediumThreshold</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Sample Risk Examples -->
    <div class="row">
        <div class="col-12">
            <div class="preview-section">
                <h5 class="mb-3">
                    <i class="fas fa-eye me-2"></i>Sample Risk Classifications
                </h5>
                <p class="text-muted mb-4">Examples of how different values would be classified with these settings:</p>

                <div class="row">
                    <div class="col-md-6">
                        <h6 class="text-primary mb-3">FAIR Examples</h6>
                        <div class="sample-risk border-start border-danger border-3">
                            <span>ALE: $2,000,000</span>
                            <span class="badge bg-danger">@Model.GetFairRiskLevel(2000000)</span>
                        </div>
                        <div class="sample-risk border-start border-warning border-3">
                            <span>ALE: $500,000</span>
                            <span class="badge bg-warning">@Model.GetFairRiskLevel(500000)</span>
                        </div>
                        <div class="sample-risk border-start border-info border-3">
                            <span>ALE: $50,000</span>
                            <span class="badge bg-info">@Model.GetFairRiskLevel(50000)</span>
                        </div>
                        <div class="sample-risk border-start border-success border-3">
                            <span>ALE: $5,000</span>
                            <span class="badge bg-success">@Model.GetFairRiskLevel(5000)</span>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <h6 class="text-success mb-3">Qualitative Examples</h6>
                        <div class="sample-risk border-start border-danger border-3">
                            <span>Risk Score: 16.0</span>
                            <span class="badge bg-danger">@Model.GetQualitativeRiskLevel(16)</span>
                        </div>
                        <div class="sample-risk border-start border-warning border-3">
                            <span>Risk Score: 12.0</span>
                            <span class="badge bg-warning">@Model.GetQualitativeRiskLevel(12)</span>
                        </div>
                        <div class="sample-risk border-start border-info border-3">
                            <span>Risk Score: 8.0</span>
                            <span class="badge bg-info">@Model.GetQualitativeRiskLevel(8)</span>
                        </div>
                        <div class="sample-risk border-start border-success border-3">
                            <span>Risk Score: 3.0</span>
                            <span class="badge bg-success">@Model.GetQualitativeRiskLevel(3)</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Metadata -->
    <div class="row mt-4">
        <div class="col-12">
            <div class="card">
                <div class="card-header">
                    <h6 class="mb-0">Configuration Details</h6>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-3">
                            <strong>Created By:</strong><br>
                            @Model.CreatedBy
                        </div>
                        <div class="col-md-3">
                            <strong>Created Date:</strong><br>
                            @Model.CreatedDate.ToString("MMMM dd, yyyy 'at' HH:mm")
                        </div>
                        <div class="col-md-3">
                            <strong>Last Modified By:</strong><br>
                            @Model.LastModifiedBy
                        </div>
                        <div class="col-md-3">
                            <strong>Last Modified:</strong><br>
                            @Model.LastModifiedDate.ToString("MMMM dd, yyyy 'at' HH:mm")
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Action Buttons -->
    <div class="text-center mt-4">
        @if (Model.IsActive)
        {
            <div class="btn-group" role="group">
                <a asp-action="Edit" asp-route-id="@Model.Id" class="btn btn-warning btn-lg">
                    <i class="fas fa-edit me-2"></i>Modify Settings
                </a>
                <a asp-action="Create" class="btn btn-primary btn-lg">
                    <i class="fas fa-copy me-2"></i>Create New Configuration
                </a>
            </div>

            <div class="mt-3">
                <form asp-action="ResetToDefault" method="post" style="display: inline;" onsubmit="return confirm('Are you sure you want to reset to default settings? This will create a new configuration with default values.')">
                    <button type="submit" class="btn btn-outline-secondary">
                        <i class="fas fa-undo me-2"></i>Reset to Defaults
                    </button>
                </form>
            </div>
        }
        else
        {
            <a asp-action="Edit" asp-route-id="@Model.Id" class="btn btn-success btn-lg">
                <i class="fas fa-check me-2"></i>Activate These Settings
            </a>
        }
    </div>
</div>